<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Database Server - </title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <base href="../../">

        <link rel="stylesheet" href="book.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">

        <!-- MathJax -->
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Fetch JQuery from CDN but have a local fallback -->
        <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script>
            if (typeof jQuery == 'undefined') {
                document.write(unescape("%3Cscript src='jquery.js'%3E%3C/script%3E"));
            }
        </script>
    </head>
    <body class="light">
        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme = localStorage.getItem('theme');
            if (theme == null) { theme = 'light'; }
            $('body').removeClass().addClass(theme);
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var sidebar = localStorage.getItem('sidebar');
            if (sidebar === "hidden") { $("html").addClass("sidebar-hidden") }
            else if (sidebar === "visible") { $("html").addClass("sidebar-visible") }
        </script>

        <div id="sidebar" class="sidebar">
            <ul class="chapter"><li class="affix"><a href="Home.html">Introduction</a></li><li class="affix"><a href="gettingStarted.html">Getting Started</a></li><li><a href="1-Sensys/1.1-Overview.html"><strong>1.</strong> Sensys</a></li><li><ul class="section"><li><a href="1-Sensys/1.2-Core-Features.html"><strong>1.1.</strong> Core features</a></li></ul></li><li><strong>2.</strong> Sensys Build and Installation</li><li><ul class="section"><li><a href="2-Build-and-Installation-Guide/2.1-Sensys-Build-and-Installation/2.1.01-Build-Dependencies.html"><strong>2.1.</strong> Build Dependencies</a></li><li><a href="2-Build-and-Installation-Guide/2.1-Sensys-Build-and-Installation/2.1.02-Pre-build-Configuration.html"><strong>2.2.</strong> Pre build Configuration</a></li><li><a href="2-Build-and-Installation-Guide/2.1-Sensys-Build-and-Installation/2.1.03-Build-From-SRPMS.html"><strong>2.3.</strong> Build From SRPMS</a></li><li><a href="2-Build-and-Installation-Guide/2.1-Sensys-Build-and-Installation/2.1.04-Relocate-RPM-Install-Path.html"><strong>2.4.</strong> Relocate RPM Install Path</a></li><li><a href="2-Build-and-Installation-Guide/2.1-Sensys-Build-and-Installation/2.1.05-Build-From-Source-Tar-Files.html"><strong>2.5.</strong> Build From Source Tar Files</a></li><li><a href="2-Build-and-Installation-Guide/2.1-Sensys-Build-and-Installation/2.1.06-Build-From-GitHub-Repo.html"><strong>2.6.</strong> Build From GitHub Repo</a></li><li><a href="2-Build-and-Installation-Guide/2.1-Sensys-Build-and-Installation/2.1.07-Post-build-Configuration.html"><strong>2.7.</strong> Post build Configuration</a></li><li><a href="2-Build-and-Installation-Guide/2.1-Sensys-Build-and-Installation/2.1.08-Setting-Up-pre-requisites-for-RAS-Monitoring.html"><strong>2.8.</strong> Setting Up pre requisites for RAS Monitoring</a></li><li><a href="2-Build-and-Installation-Guide/2.1-Sensys-Build-and-Installation/2.1.09-Startup-Instructions.html"><strong>2.9.</strong> Startup Instructions</a></li><li><a href="2-Build-and-Installation-Guide/2.1-Sensys-Build-and-Installation/2.1.10-Troubleshooting.html"><strong>2.10.</strong> Troubleshooting</a></li><li><a href="2-Build-and-Installation-Guide/2.1-Sensys-Build-and-Installation/2.1.11-Setting-MCA-Parameters.html"><strong>2.11.</strong> Setting MCA Parameters</a></li><li><strong>2.12.</strong> Database Installation</li><li><ul class="section"><li><a href="2-Build-and-Installation-Guide/2.2-Database-Installation/2.2.1-Database-Server.html" class="active"><strong>2.12.1.</strong> Database Server</a></li><li><a href="2-Build-and-Installation-Guide/2.2-Database-Installation/2.2.2-Database-Connectivity.html"><strong>2.12.2.</strong> Database Connectivity</a></li><li><a href="2-Build-and-Installation-Guide/2.2-Database-Installation/2.2.3-Enabling-Data-Purge.html"><strong>2.12.3.</strong> Enabling Data Purge</a></li><li><a href="2-Build-and-Installation-Guide/2.2-Database-Installation/2.2.4-Monitoring-Database-Size.html"><strong>2.12.4.</strong> Monitoring Database Size</a></li><li><a href="2-Build-and-Installation-Guide/2.2-Database-Installation/2.2.5-Database-Distro-Specific-Examples.html"><strong>2.12.5.</strong> Database Distro Specific Examples</a></li><li><a href="2-Build-and-Installation-Guide/2.2-Database-Installation/2.2.6-Database-ZeroMQ-Publishing.html"><strong>2.12.6.</strong> Database ZeroMQ Publishing</a></li></ul></li></ul></li><li><strong>3.</strong> Sensys User Guide</li><li><ul class="section"><li><a href="3-Sensys-User-Guide/3.1-Overview.html"><strong>3.1.</strong> Overview</a></li><li><a href="3-Sensys-User-Guide/3.2-orcmd.html"><strong>3.2.</strong> orcmd</a></li><li><a href="3-Sensys-User-Guide/3.3-orcmsched.html"><strong>3.3.</strong> orcmsched</a></li><li><a href="3-Sensys-User-Guide/3.4-Sensys-CFGI-User-Guide.html"><strong>3.4.</strong> Sensys CFGI User Guide</a></li><li><a href="3-Sensys-User-Guide/3.5-Sensys-Regex.html"><strong>3.5.</strong> Sensys Regex</a></li><li><a href="3-Sensys-User-Guide/3.6-Sensys-Logical-Grouping.html"><strong>3.6.</strong> Sensys Logical Grouping</a></li><li><a href="3-Sensys-User-Guide/3.7-octl.html"><strong>3.7.</strong> octl</a></li><li><a href="3-Sensys-User-Guide/3.8-RAS-Monitoring.html"><strong>3.8.</strong> RAS Monitoring</a></li><li><a href="3-Sensys-User-Guide/3.9-Data-Smoothing-Algorithms-Analytics.html"><strong>3.9.</strong> Data Smoothing Algorithms Analytics</a></li><li><a href="3-Sensys-User-Guide/3.10-ErrorManager-Notification.html"><strong>3.10.</strong> ErrorManager Notification</a></li><li><a href="3-Sensys-User-Guide/3.11-Diagnostics.html"><strong>3.11.</strong> Diagnostics</a></li><li><a href="3-Sensys-User-Guide/3.12-Sensys-Security-Aspects.html"><strong>3.12.</strong> Sensys Security Aspects</a></li><li><a href="3-Sensys-User-Guide/3.13-Sensys-Database-Multiple-Threads.html"><strong>3.13.</strong> Sensys Database Multiple Threads</a></li><li><a href="3-Sensys-User-Guide/3.14-Sensys-Database-Multi-Select.html"><strong>3.14.</strong> Sensys Database Multi Select</a></li></ul></li><li><strong>4.</strong> Developer Guide</li><li><ul class="section"><li><a href="4-Developer-Guide/4.1-Sensys-DB-Framework-API/4.1.1-DB-Framework-API-Design.html"><strong>4.1.</strong> DB Framework API Design</a></li><li><a href="4-Developer-Guide/4.1-Sensys-DB-Framework-API/4.1.2-DB-Framework-API.html"><strong>4.2.</strong> DB Framework API</a></li><li><a href="4-Developer-Guide/4.2-Sensys-DB-API/4.2.1-DB-API.html"><strong>4.3.</strong> DB API</a></li><li><a href="4-Developer-Guide/4.3-Sensys-DB-Schema/4.3.1-DB-Schema-V2,0.html"><strong>4.4.</strong> DB Schema V2,0</a></li><li><a href="4-Developer-Guide/4.4-Sensys-Simplified-Analytics-Interface/4.4.1-Analytics-Plugin-API.html"><strong>4.5.</strong> Analytics Plugin API</a></li><li><a href="4-Developer-Guide/4.4-Sensys-Simplified-Analytics-Interface/4.4.2-Analytics-Plugin-Development.html"><strong>4.6.</strong> Analytics Plugin Development</a></li><li><a href="4-Developer-Guide/4.4-Sensys-Simplified-Analytics-Interface/4.4.3-Analytics-Plugin-Build-Install.html"><strong>4.7.</strong> Analytics Plugin Build Install</a></li><li><a href="4-Developer-Guide/4.5-Sensys-Simplified-Sensor-Interface/4.5.1-Sensor-Plugin-API.html"><strong>4.8.</strong> Sensor Plugin API</a></li><li><a href="4-Developer-Guide/4.5-Sensys-Simplified-Sensor-Interface/4.5.2-Sensor-Plugin-Development.html"><strong>4.9.</strong> Sensor Plugin Development</a></li><li><a href="4-Developer-Guide/4.5-Sensys-Simplified-Sensor-Interface/4.5.3-Sensor-Plugin-Build-Install.html"><strong>4.10.</strong> Sensor Plugin Build Install</a></li><li><a href="4-Developer-Guide/4.6-dataContainer-reference.html"><strong>4.11.</strong> <code>dataContainer</code> class reference</a></li></ul></li><li><strong>5.</strong> Testing</li><li><ul class="section"><li><a href="5-Testing/5.1-Docker/5.1.1-Centos-Docker-Guide.html"><strong>5.1.</strong> Centos Docker Guide</a></li><li><a href="5-Testing/5.1-Docker/5.1.2-Multihost-Docker.html"><strong>5.2.</strong> Multihost Docker</a></li><li><a href="5-Testing/5.1-Docker/5.1.3-Cluster-Docker.html"><strong>5.3.</strong> Cluster Docker</a></li></ul></li><li><strong>6.</strong> Appendix</li><li><ul class="section"><li><a href="Appendix/A.1-Terminology.html"><strong>6.1.</strong> Terminology</a></li><li><a href="Appendix/A.2-Sensys-Governance-Model/A.2.1-Following-the-Open-MPI-Model.html"><strong>6.2.</strong> Following the Open MPI Model</a></li><li><a href="Appendix/A.2-Sensys-Governance-Model/A.2.2-Contributing-to-the-Source-Code.html"><strong>6.3.</strong> Contributing to the Source Code</a></li><li><a href="Appendix/A.2-Sensys-Governance-Model/A.2.3-Development-Process.html"><strong>6.4.</strong> Development Process</a></li><li><a href="Appendix/A.2-Sensys-Governance-Model/A.2.4-Roles-and-Responsibilities.html"><strong>6.5.</strong> Roles and Responsibilities</a></li><li><a href="Appendix/A.2-Sensys-Governance-Model/A.2.5-Filing-Issues.html"><strong>6.6.</strong> Filing Issues</a></li><li><a href="Appendix/A.3-Maintaining-the-Wiki.html"><strong>6.7.</strong> Maintaining the Wiki</a></li></ul></li></ul>
        </div>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar" class="menu-bar">
                    <div class="left-buttons">
                        <i id="sidebar-toggle" class="fa fa-bars"></i>
                        <i id="theme-toggle" class="fa fa-paint-brush"></i>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <i id="print-button" class="fa fa-print" title="Print this book"></i>
                    </div>
                </div>

                <div id="content" class="content">
                    <a class="header" href="2-Build-and-Installation-Guide/2.2-Database-Installation/2.2.1-Database-Server.html#database-installation" id="database-installation"><h1>Database Installation</h1></a>
<p>This section provides instructions on how to set up the Sensys DB.  These instructions are meant to be executed on the server that will contain the database.  At the moment, Sensys provides support for PostgreSQL, so the following sections will provide instructions on how to set up the database using this DBMS.</p>
<p>To complete the following steps, the following file is needed: “orcmdb_psql.sql” (found in the Sensys repository in the “contrib/database” directory).</p>
<p>NOTE: the following instructions will use the following settings as reference, but the database administrator may choose to use different settings:</p>
<ul>
<li>Database instance name: <em>orcmdb</em></li>
<li>Database user: <em>orcmuser</em></li>
</ul>
<a class="header" href="2-Build-and-Installation-Guide/2.2-Database-Installation/2.2.1-Database-Server.html#software-requirements" id="software-requirements"><h4>Software Requirements</h4></a>
<a class="header" href="2-Build-and-Installation-Guide/2.2-Database-Installation/2.2.1-Database-Server.html#requirements-for-postgresql" id="requirements-for-postgresql"><h5>Requirements for PostgreSQL</h5></a>
<table><thead><tr><th> Package              </th><th> Version         </th><th> Req. </th><th> Notes                                                                                                                                                                                                  </th></tr></thead><tbody>
<tr><td> PostgreSQL Server    </td><td> 9.2 or higher   </td><td> Yes  </td><td> Required on database server </td></tr>
<tr><td> PostgreSQL Client    </td><td> 9.2 or higher   </td><td> Yes  </td><td> Required on database server </td></tr>
</tbody></table>
<p>NOTE: Client may be installed on any machine for administrative tasks: testing the database connection,
data and schema management, etc.</p>
<a class="header" href="2-Build-and-Installation-Guide/2.2-Database-Installation/2.2.1-Database-Server.html#installation-overview" id="installation-overview"><h4>Installation Overview</h4></a>
<p>At a high level, installing the database requires the following steps:</p>
<ol>
<li>Installing the DBMS</li>
<li>Performing some configuration tasks (e.g. enabling remote access to the database)</li>
<li>Creating the database</li>
<li>Performing basic DBA tasks: creating users and roles</li>
</ol>
<a class="header" href="2-Build-and-Installation-Guide/2.2-Database-Installation/2.2.1-Database-Server.html#notes-on-user-privileges" id="notes-on-user-privileges"><h4>Notes On User Privileges</h4></a>
<p>For simplicity, the following steps provide instructions for creating a single database user with all the privileges.  However, it’s recommended to create roles and set privileges appropriately.  It’s up to the DBA to decide this and it will depend on the number of users that need to be managed and on organization policies.</p>
<p>General recommendations regarding users and privileges:</p>
<ul>
<li>A separate administrative user should be created and it should be used to create the database.</li>
<li>Roles should be used to manage user privileges.  Administrative users should have all privileges on the database while regular users should be restricted (depending on the data they need to access for their tasks).</li>
<li>The standard Sensys user should have the following privileges:
<ul>
<li>Select, insert, update and delete privileges on all tables</li>
<li>Execute privileges on all stored procedures</li>
</ul>
</li>
</ul>
<a class="header" href="2-Build-and-Installation-Guide/2.2-Database-Installation/2.2.1-Database-Server.html#preparing-the-server" id="preparing-the-server"><h4>Preparing the Server</h4></a>
<a class="header" href="2-Build-and-Installation-Guide/2.2-Database-Installation/2.2.1-Database-Server.html#postgresql-installation" id="postgresql-installation"><h5>PostgreSQL installation</h5></a>
<ol>
<li>
<p>Install the PostgreSQL server and client</p>
<ul>
<li>Please refer to the PostgreSQL documentation for installation instructions</li>
<li><a href="https://wiki.postgresql.org/wiki/Detailed_installation_guides">PostgreSQL installation wiki</a></li>
</ul>
</li>
<li>
<p>Verify the installation by starting the <em>postgresql</em> service</p>
<pre><code>% service postgresql start
</code></pre>
<ul>
<li>NOTE:
<ul>
<li>Depending on the version, before being able to start the service it may be necessary to execute:
<pre><code>% service postgresql initdb`
</code></pre>
</li>
<li>If desired, the service may be configured to start automatically:
<pre><code>% chkconfig postgresql on
</code></pre>
</li>
<li>The actual name of the service may vary (e.g. “postgresql-9.2”)</li>
<li>These commands need to be run with administrative privileges</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Enable external TCP connections to the <em>postgresql</em> service</p>
<ul>
<li>Make sure the firewall is configured to allow incoming connections to the <em>postgresql</em> service port (5432 by default)</li>
<li>Enable client authentication
<ul>
<li>Edit the “pg_hba.conf” configuration file
<ul>
<li>The file location may vary depending on the installation package used</li>
<li>For example:
<ul>
<li>“/etc/postgresql/9.2/main”</li>
<li>“/var/lib/pgsql/9.2/data/”</li>
</ul>
</li>
</ul>
</li>
<li>The file contains detailed instructions on how to add authentication configuration options</li>
<li>At the very least, external connections should be allowed to the <em>orcmdb</em> database</li>
<li>Recommendation: start with basic password authentication and try more secure configurations once this is working</li>
</ul>
</li>
<li>Enable networking for PostgreSQL
<ul>
<li>Edit the “postgresql.conf” configuration file</li>
<li>Edit the following line to specify what IP addresses to listen on:
<pre><code>listen_addresses = &lt;comma-separated list of addresses&gt;
</code></pre>
<ul>
<li>NOTE: use '*’ to specify all</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Create <em>orcmuser</em></p>
<ul>
<li>Use the <em>createuser</em> command as the default <em>postgres</em> user:
<pre><code>% sudo –u postgres createuser –P orcmuser
</code></pre>
</li>
<li>NOTE:
<ul>
<li>This command will prompt the user for a password.  Please choose a strong password.</li>
<li>To verify if the user was created successfully, execute '\du' from a <em>psql</em> session.</li>
<li>Depending on the authentication configuration in “pg_hba.conf” for local connections, the <em>orcmuser</em> may not be allowed to execute this command.  An alternative for handling this is to enable password authentication for local connections (at least temporarily)</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Create the <em>orcmdb</em> database.  NOTE: this requires code from the Sensys repository under the &quot;contrib/database&quot; directory.</p>
<ol>
<li>
<p>Create the database:</p>
<pre><code>% sudo –u postgres createdb --owner orcmuser orcmdb
</code></pre>
</li>
<li>
<p>Install the database schema:</p>
<p>Sensys is distributed with a SQL script for the setup of the database schema. A file <code>sensys.sql</code> can be found under <code>contrib/database</code> folder in the source code of Sensys or <code>/opt/sensys/share/db-schema/</code> if you are installing from rpm.</p>
<p>To install the database schema run:</p>
<pre><code>psql -U orcmuser -W -f sensys.sql orcmdb
</code></pre>
</li>
</ol>
</li>
<li>
<p>Verify the installation</p>
<ul>
<li>Make sure the database server is listening on a port
<pre><code>netstat -plane |grep postmaster
</code></pre>
</li>
<li>Connect to the database from a remote machine:
<pre><code>psql –-host=&lt;hostname or IP address&gt; -–username=orcmuser –-dbname=orcmdb --password
</code></pre>
</li>
<li>List the database’s tables:
<pre><code>\dt
</code></pre>
<ul>
<li>Here are some of the tables that will be listed
<ul>
<li>data_item</li>
<li>data_sample</li>
<li>event</li>
<li>event_type</li>
<li>fru</li>
<li>fru_type</li>
<li>job</li>
<li>job_node</li>
<li>maintenance_record</li>
<li>node</li>
</ul>
</li>
<li>See <a href="4.3-Sensys-DB-Schema">4.3 Sensys DB Schema</a> for the DB schema diagrams</li>
</ul>
</li>
</ul>
</li>
</ol>

                </div>

                <!-- Mobile navigation buttons -->
                
                    <a href="2-Build-and-Installation-Guide/2.1-Sensys-Build-and-Installation/2.1.11-Setting-MCA-Parameters.html" class="mobile-nav-chapters previous">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="2-Build-and-Installation-Guide/2.2-Database-Installation/2.2.2-Database-Connectivity.html" class="mobile-nav-chapters next">
                        <i class="fa fa-angle-right"></i>
                    </a>
                

            </div>

            
                <a href="2-Build-and-Installation-Guide/2.1-Sensys-Build-and-Installation/2.1.11-Setting-MCA-Parameters.html" class="nav-chapters previous" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-left"></i>
                </a>
            

            
                <a href="2-Build-and-Installation-Guide/2.2-Database-Installation/2.2.2-Database-Connectivity.html" class="nav-chapters next" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-right"></i>
                </a>
            

        </div>


        <!-- Local fallback for Font Awesome -->
        <script>
            if ($(".fa").css("font-family") !== "FontAwesome") {
                $('<link rel="stylesheet" type="text/css" href="_FontAwesome/css/font-awesome.css">').prependTo('head');
            }
        </script>

        <!-- Livereload script (if served using the cli tool) -->
        

        


        <script src="highlight.js"></script>
        <script src="book.js"></script>
    </body>
</html>
